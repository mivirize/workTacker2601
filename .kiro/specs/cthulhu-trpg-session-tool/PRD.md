# Product Requirements Document (PRD)
## クトゥルフ神話TRPGセッションツール (Project C)

### 1. ドキュメント情報

- **ドキュメント名**: クトゥルフ神話TRPGセッションツール PRD
- **バージョン**: 1.0
- **作成日**: 2025年8月26日
- **作成者**: Sonic AI
- **対象プロジェクト**: Project C
- **最終更新日**: 2025年8月26日

### 2. 概要

Project Cは、クトゥルフ神話TRPGに特化したオンラインセッションツールで、従来のセッション管理機能に加えて、AI技術を活用した二次創作支援機能を提供します。React + Next.js + Tailwind CSSをベースとしたモダンなWebアプリケーションとして構築し、リアルタイム通信とAI統合を核とした設計を採用します。

### 3. 目的と目標

#### 3.1 ビジョン
「セッションを創作活動に変える」

#### 3.2 目的
- クトゥルフ神話TRPGのセッションをより快適で創造的な体験に変える
- セッションのログを二次創作の素材として活用できるようにする
- AI技術を活用して、キーパーの負担を軽減し、より豊かな世界観を提供する

#### 3.3 目標
1. 従来のTRPGセッション機能を全て実装し、オンラインで快適にプレイできる環境を提供
2. AIを活用した描写補助、ロールプレイ提案、小説生成等の創作支援機能を導入
3. セッションのログを自動保存し、あらすじ生成や小説化を可能にする
4. 直感的なUI/UXとスキン機能で個性的なセッション環境を提供

### 4. 対象ユーザー

- **プライマリユーザー**: クトゥルフ神話TRPGをプレイするプレイヤー
- **セカンダリユーザー**: クトゥルフ神話TRPGのキーパー（KP）
- **ターゲット層**: セッションログを二次創作に活用したいクリエイティブなユーザー
- **スキルレベル**: TRPG初心者から上級者まで対応

### 5. 機能要件

#### 5.1 ユーザー認証システム
- Google OAuthによる簡単ログイン
- セッション管理と自動再認証
- エラーハンドリングと再試行機能

#### 5.2 キャラクターシート管理機能
- クトゥルフ神話TRPG 6版・7版対応
- 能力値、スキル、バックグラウンドの管理
- 保存上限と有料プラン案内
- 共有機能と公開設定

#### 5.3 ダイス機能
- クトゥルフ神話TRPGルール準拠の判定
- クリティカル/ファンブルの視覚的表現
- リアルタイム結果同期
- ダイスロール履歴管理

#### 5.4 シナリオ管理機能
- シナリオ作成・編集機能
- 演出素材のアップロードと管理
- リアルタイム素材同期
- シーンごとの素材紐付け

#### 5.5 AI描写補助機能
- キーワードからの情景描写生成
- チャットへの直接貼り付け機能
- 利用回数制限と有料プラン案内
- 再生成と品質管理

#### 5.6 AIロールプレイ提案機能
- キャラクター性格に合わせた提案生成
- SANチェック失敗等の自動トリガー
- 複数選択肢の提示
- 提案履歴管理

#### 5.7 セッションログ保存機能
- 自動音声・チャットログ保存
- プライバシー設定と公開範囲管理
- ログ検索・フィルタリング機能
- エクスポート機能

#### 5.8 AIあらすじ生成機能
- セッションログからの要点抽出
- SNS共有用フォーマット生成
- 共有機能と外部連携
- 利用回数制限管理

#### 5.9 AI小説生成機能
- チャットログの自然な会話変換
- ダイスロール結果の描写化
- 挿絵自動生成と配置
- PDF/EPUB形式でのエクスポート

#### 5.10 モダンUI/UXとスキン機能
- 直感的で迷わないナビゲーション
- スキン変更とプレビュー機能
- 有料スキンの購入・適用
- 一貫したデザイン適用

### 6. 非機能要件

#### 6.1 パフォーマンス
- ページロード時間: 3秒以内
- APIレスポンス時間: 500ms以内
- リアルタイム通信遅延: 100ms以内
- 同時接続ユーザー数: 100人以上

#### 6.2 セキュリティ
- OWASP準拠のセキュリティ対策
- データ暗号化（TLS 1.3）
- 認証・認可の徹底
- 定期的なセキュリティ監査

#### 6.3 可用性
- 稼働率: 99.9%以上
- 自動バックアップ
- 障害復旧時間: 1時間以内
- メンテナンス通知

#### 6.4 スケーラビリティ
- 水平スケーリング対応
- データベース最適化
- CDN活用による静的コンテンツ配信
- キャッシュ戦略の最適化

### 7. 技術要件

#### 7.1 フロントエンド
- Next.js 14 (App Router)
- React 18
- TypeScript
- Tailwind CSS
- Socket.io Client

#### 7.2 バックエンド
- Next.js API Routes
- NextAuth.js
- Prisma ORM
- Socket.io Server

#### 7.3 データベース
- PostgreSQL
- Redis (キャッシュ・セッション管理)

#### 7.4 AI・外部サービス
- OpenAI GPT-4
- Stable Diffusion API
- Google OAuth
- Cloudinary

### 8. 制約条件

#### 8.1 技術的制約
- ブラウザ対応: Chrome, Firefox, Safari, Edge (最新2バージョン)
- モバイル対応: レスポンシブデザイン
- オフライン機能: 制限なし

#### 8.2 ビジネス的制約
- 無料ユーザー制限: キャラクターシート保存数2件、AI機能利用回数制限
- 有料プラン: 月額制を基本
- 収益モデル: 機能制限解除とスキン販売

#### 8.3 法的・倫理的制約
- 著作権尊重: クトゥルフ神話の公式設定遵守
- プライバシー保護: GDPR準拠
- AI生成コンテンツの表示: 明示的な表記

### 9. 開発スケジュール

#### 9.1 フェーズ1: 基盤構築 (2週間)
- プロジェクト初期化と設定
- データベース設計と実装
- 認証システム実装

#### 9.2 フェーズ2: コア機能実装 (4週間)
- キャラクターシート管理
- ダイス機能
- リアルタイム通信基盤

#### 9.3 フェーズ3: AI機能統合 (4週間)
- AI描写補助機能
- AIロールプレイ提案機能
- セッションログ保存機能

#### 9.4 フェーズ4: 高度機能実装 (4週間)
- AIあらすじ生成機能
- AI小説生成機能
- UI/UX改善とスキン機能

#### 9.5 フェーズ5: テスト・デプロイ (2週間)
- テスト実装とQA
- 本番環境デプロイ
- モニタリング設定

### 10. リスクと対策

#### 10.1 技術的リスク
- **AI API依存リスク**: 対策 - フォールバック機能実装、複数プロバイダー検討
- **リアルタイム通信複雑化**: 対策 - 段階的実装、十分なテスト期間確保
- **パフォーマンス劣化**: 対策 - 定期的なパフォーマンステスト、早期最適化

#### 10.2 ビジネス的リスク
- **ユーザー獲得リスク**: 対策 - ベータテスト実施、フィードバック反映
- **競合サービス出現**: 対策 - 独自のAI機能強化、コミュニティ育成
- **収益モデル不確実性**: 対策 - A/Bテスト実施、柔軟な価格設定

#### 10.3 法的リスク
- **著作権問題**: 対策 - 公式ライセンス確認、独自コンテンツ開発
- **プライバシー問題**: 対策 - 専門家監修、定期的なコンプライアンスチェック

### 11. 付録

#### 11.1 参考資料
- [design.md] - 設計ドキュメント
- [requirements.md] - 要件定義ドキュメント
- [tasks.md] - 実装計画ドキュメント

#### 11.2 用語集
- **KP**: Keeper（キーパー）の略。TRPGにおけるゲームマスター
- **SANチェック**: クトゥルフ神話TRPGにおける正気度判定
- **二次創作**: 既存の作品を原作とした創作活動

#### 11.3 バージョン履歴
- v1.0 (2025/08/26): 初版作成